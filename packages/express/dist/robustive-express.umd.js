(function(s,t){typeof exports=="object"&&typeof module!="undefined"?t(exports,require("robustive-ts")):typeof define=="function"&&define.amd?define(["exports","robustive-ts"],t):(s=typeof globalThis!="undefined"?globalThis:s||self,t(s.RobustiveExpress={},s.Robustive))})(this,function(s,t){"use strict";const f=new t.SwiftEnum;t.Scenario.prototype.proceedUntilResponse=function(o,r,i,c){return this.delegate!==void 0&&this.delegate.proceedUntilResponse!==void 0?this.delegate.proceedUntilResponse(o,r,i,c,this):Promise.reject(new Error)},t.Scenario.prototype.respond=function(o,r=f.normal({statusCode:200})){return Promise.resolve({...o,status:r})},t.UsecaseImple.prototype.handleRequest=function(o,r,i,c,p){const e=this,l=(n,u,d)=>{const a=d.slice(-1)[0];return a.course==="goals"||a.status?Promise.resolve(a):e._scenario.proceedUntilResponse(n,u,a,i).then(m=>(e.currentContext=m,d.push(m),l(n,u,d)))};if(e._scenario.authorize&&!e._scenario.authorize(i,e._domain,e._usecase)){const n=new t.ActorNotAuthorizedToInteractIn(i,e._domain,e._usecase);return Promise.reject(n)}const h=[e.currentContext];return c?c.run(p!=null?p:{},async()=>{var n,u;try{return await l(o,r,h)}finally{await((u=(n=e._scenario.delegate)==null?void 0:n.gracefullyComplete)==null?void 0:u.call(n,"handleRequest.finally"))}}):l(o,r,h)},s.ResponseStatus=f,Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=robustive-express.umd.js.map
